<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bingo Player</title>
<style>
  #board { display: grid; grid-template-columns: repeat(5, 60px); gap: 5px; margin-top: 10px; }
  .cell { width: 60px; height: 60px; border: 1px solid #333; display:flex; justify-content:center; align-items:center; font-weight:bold; font-size:18px; }
  .marked { background-color: green; color: white; }
</style>
</head>
<body>
<h1>Stanislas' Bingo</h1>
<h2>Bingo Player</h2>
<label>Name: <input id="name" placeholder="Enter your name"></label>
<button onclick="join()">Join Game</button>

<div id="board"></div>
<div id="calledNumbers"></div>

<script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
<script>
const socket = io("https://server.ctksystem.com")
let board = []

function join(){
  const name = document.getElementById("name").value || "Anonymous"
  socket.emit("join", name)
}

// Receive board from server
socket.on("board", b=>{
  board = b
  renderBoard()
})

// Receive all previously called numbers
socket.on("called_numbers", nums=>{
  nums.forEach(n=>markNumber(n))
})

// When admin calls a new number
socket.on("number_called", n=>{
  markNumber(n)
})

// Bingo notification
socket.on("bingo", ()=>alert("Bingo!"))

// Render board
function renderBoard(){
  const div = document.getElementById("board")
  div.innerHTML=""
  board.forEach((val,i)=>{
    const cell = document.createElement("div")
    cell.className="cell"
    cell.textContent=val
    if(val==="FREE") cell.classList.add("marked")
    cell.id="cell_"+i
    div.appendChild(cell)
  })
}

// Mark a number if it matches
function markNumber(n){
  const idx = board.findIndex(v=>v===n)
  if(idx===-1) return
  board[idx] = n // keep value
  const c = document.getElementById("cell_"+idx)
  if(c) c.classList.add("marked")
}
</script>
</body>
</html>
